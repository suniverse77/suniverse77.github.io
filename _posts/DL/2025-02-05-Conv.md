---
title: "[CNN] Convolution ì—°ì‚° ì¢…ë¥˜"
date: 2025-02-05 00:00:00 +/-TTTT
categories: [AI, ë”¥ëŸ¬ë‹]
tags: [CS231n]
math: true
toc: true
author: sunho
description: ğŸ“– Stanford CS231n | Spring 2025 | Lecture 1
---

## Standard Convolution

ì»¨ë³¼ë£¨ì…˜ì€ í•„í„° (ë˜ëŠ” ì»¤ë„ì´ë¼ê³ ë„ ë¶€ë¦„)ì™€ ì…ë ¥ ì´ë¯¸ì§€ì˜ ì¼ë¶€ë¶„ì„ ë‚´ì í•´ì„œ í•˜ë‚˜ì˜ ìŠ¤ì¹¼ë¼ë¥¼ ì¶œë ¥í•˜ëŠ” ì—°ì‚°ì´ë‹¤.

ì¦‰, ì¶œë ¥ë˜ëŠ” ê°’ì€ ì´ë¯¸ì§€ì˜ íŠ¹ì • ë¶€ë¶„ì´ í•„í„°ì™€ ì–¼ë§ˆë‚˜ ì¼ì¹˜í•˜ëŠ”ì§€ë¥¼ ë‚˜íƒ€ë‚´ëŠ” ê°’ìœ¼ë¡œ ë³¼ ìˆ˜ ìˆë‹¤.

![fig1](dl/Conv-1.png){: style="display:block; margin:0 auto; width:60%;"}
_[[ì¶œì²˜]](https://sotudy.tistory.com/10)_

ì»¨ë³¼ë£¨ì…˜ ì—°ì‚°ì´ ì§„í–‰ë˜ëŠ” ë°©ì‹ì€ ì•„ë˜ì™€ ê°™ë‹¤.

![fig2](dl/Conv-2.gif){: style="display:block; margin:0 auto; width:80%;"}
_[[ì¶œì²˜]](https://medium.com/@mokeam/2d-image-convolution-267fa2ac8197)_

ê¸°ë³¸ ì»¨ë³¼ë£¨ì…˜ì˜ ì—°ì‚°ëŸ‰ì€ ì•„ë˜ì™€ ê°™ë‹¤.

$$
\left[\left(K^2\cdot C_{in}\right)\cdot HW\right]\cdot C_{out}
$$

- í•„í„°ì˜ í¬ê¸°ê°€ $C_{in}\times K\times K$ì¼ ë•Œ, í•„í„° í•˜ë‚˜ì— ì˜í•´ ë°œìƒí•˜ëŠ” ì—°ì‚° íšŸìˆ˜ëŠ” $K^2\cdot C_{in}$ì´ë‹¤.
- í•„í„°ê°€ ì´ë¯¸ì§€ì˜ ëª¨ë“  ì˜ì—­ì„ ì§€ë‚˜ê¸° ë•Œë¬¸ì— $K^2\cdot C_{in}$ì˜ ì—°ì‚°ì´ $HW$ë²ˆ ìˆ˜í–‰ëœë‹¤.
- ì¶œë ¥ ì±„ë„ $C_{out}$ì€ í•„í„°ì˜ ê°œìˆ˜ì™€ ë™ì¼í•˜ë¯€ë¡œ, ìµœì¢…ì ìœ¼ë¡œ $(K^2\cdot C_{in})\cdot HW$ì˜ ì—°ì‚°ì´ $C_{out}$ë²ˆ ìˆ˜í–‰ëœë‹¤.

### Stride

StrideëŠ” í•„í„°ê°€ í•œ ë²ˆì— ì›€ì§ì´ëŠ” ë³´í­ì„ ì˜ë¯¸í•˜ë©°, receptive fieldë¥¼ ë¹ ë¥´ê²Œ ì¦ê°€ì‹œí‚¬ ë•Œ ì‚¬ìš©í•œë‹¤.

ì¼ë°˜ì ì¸ ì»¨ë³¼ë£¨ì…˜ ì—°ì‚°ì€ $s=1$ì´ë©°, $s=2$ì´ë©´ í•„í„°ëŠ” í•œ ë²ˆì— ë‘ ì¹¸ì”© ì›€ì§ì¸ë‹¤.

![fig3](dl/Conv-3.gif){: style="display:block; margin:0 auto; width:60%;"}
_[[ì¶œì²˜]](https://velog.io/@hayaseleu/Transposed-Convolutional-Layer%EC%9D%80-%EB%AC%B4%EC%97%87%EC%9D%B8%EA%B0%80)_

### Padding

Paddingì€ ì…ë ¥ì˜ ê°€ì¥ìë¦¬ì—ì„œ ì„ì˜ë¡œ ì˜ì—­ì„ í™•ì¥í•˜ëŠ” ê²ƒìœ¼ë¡œ, ì¶œë ¥ì˜ ê³µê°„ì  í¬ê¸°ë¥¼ ì…ë ¥ê³¼ ë™ì¼í•˜ê²Œ ìœ ì§€í•˜ê³  ì‹¶ì„ ë•Œ ì‚¬ìš©í•œë‹¤.

ê¸°ë³¸ê°’ì€ $p=0$ì´ë©°, $p=1$ì´ë©´ ì‚¬ë°©ìœ¼ë¡œ 1ì¹¸ì”© ì˜ì—­ì´ í™•ì¥ëœë‹¤.

![fig4](dl/Conv-4.gif){: style="display:block; margin:0 auto; width:60%;"}
_[[ì¶œì²˜]](https://velog.io/@hayaseleu/Transposed-Convolutional-Layer%EC%9D%80-%EB%AC%B4%EC%97%87%EC%9D%B8%EA%B0%80)_

ì¼ë°˜ì ìœ¼ë¡œ ê°€ì¥ìë¦¬ì— 0ê°’ì„ ì±„ìš°ëŠ” zero paddingì„ ì£¼ë¡œ ì‚¬ìš©í•œë‹¤.

### ì¶œë ¥ íŠ¹ì§•ë§µì˜ í¬ê¸° ê³„ì‚°

$$
O=\frac{I+2p-K}{s}+1
$$

- $I$ëŠ” ì…ë ¥ í¬ê¸°, $K$ëŠ” í•„í„° í¬ê¸°, $p$ëŠ” íŒ¨ë”© í¬ê¸°, $s$ëŠ” stride ê°’ì„ ì˜ë¯¸í•œë‹¤.
- Conv layerì—ì„œëŠ” ì…ë ¥ê³¼ í•„í„°ê°€ ì •ì‚¬ê°í˜• í˜•íƒœì´ê¸° ë•Œë¬¸ì— í¬ê¸°ëŠ” ê°€ë¡œ ë˜ëŠ” ì„¸ë¡œë¥¼ ì˜ë¯¸í•œë‹¤.

## Depthwise Convolution

ì»¨ë³¼ë£¨ì…˜ ì—°ì‚°ì„ ì±„ë„ ë³„ë¡œ ë…ë¦½ì ìœ¼ë¡œ ì§„í–‰í•˜ì—¬ ì±„ë„ë³„ë¡œ íŠ¹ì§•ë§µì„ ì¶œë ¥í•œë‹¤.

ë”°ë¼ì„œ ì…ë ¥ ì±„ë„ì˜ í¬ê¸°ì™€ ì¶œë ¥ ì±„ë„ì˜ í¬ê¸°ê°€ ê°™ë‹¤.

![fig5](dl/Conv-5.png){: style="display:block; margin:0 auto; width:60%;"}
_[[ì¶œì²˜]](https://medium.com/@zurister/depth-wise-convolution-and-depth-wise-separable-convolution-37346565d4ec)_

![fig6](dl/Conv-6.png){: style="display:block; margin:0 auto; width:80%;"}
_[[ì¶œì²˜]](https://medium.com/@zurister/depth-wise-convolution-and-depth-wise-separable-convolution-37346565d4ec)_

Depthwise ì»¨ë³¼ë£¨ì…˜ì—ì„œëŠ” ì…ë ¥ ì±„ë„ë§ˆë‹¤ í•„í„°ê°€ 1ê°œë§Œ ì¡´ì¬í•˜ë¯€ë¡œ, ì—°ì‚°ëŸ‰ì€ ì•„ë˜ì™€ ê°™ë‹¤.

$$
\left(K^2\cdot C_{in}\right)\cdot HW
$$

ë”°ë¼ì„œ ê¸°ë³¸ ì»¨ë³¼ë£¨ì…˜ë³´ë‹¤ ì—°ì‚°ëŸ‰ì´ ì ë‹¤ëŠ” ì¥ì ì´ ìˆë‹¤.

í•˜ì§€ë§Œ ê° ì±„ë„ì„ ë…ë¦½ì ìœ¼ë¡œ ì²˜ë¦¬í•˜ê¸° ë•Œë¬¸ì— ì±„ë„ ê°„ ìƒí˜¸ì‘ìš©ì´ ì•½í•˜ë‹¤ëŠ” ë‹¨ì ì´ ìˆë‹¤.

## Pointwise Convolution

$1\times1$ í•„í„°ë¥¼ ì´ìš©í•´ ì±„ë„ ë°©í–¥ìœ¼ë¡œ ë‚´ì ì„ ìˆ˜í–‰í•œë‹¤. ì´ë¥¼ í†µí•´ ì±„ë„ ê°„ ìƒí˜¸ì‘ìš©ì„ ë§Œë“ ë‹¤.

![fig7](dl/Conv-7.png){: style="display:block; margin:0 auto; width:60%;"}
_[[ì¶œì²˜]](https://sotudy.tistory.com/10)_

Pointwise ì»¨ë³¼ë£¨ì…˜ì—ì„œëŠ” $K=1$ì´ë¯€ë¡œ, ì—°ì‚°ëŸ‰ì€ ì•„ë˜ì™€ ê°™ë‹¤.

$$
\left(HW\cdot C_{in}\right)\cdot C_{out}
$$

## Depthwise Separable Convolution

Depthwise ì»¨ë³¼ë£¨ì…˜ê³¼ Pointwise ì»¨ë³¼ë£¨ì…˜ì„ í•©ì¹œ ì—°ì‚°ìœ¼ë¡œ, [MobilNets](https://arxiv.org/abs/1704.04861) ë…¼ë¬¸ì—ì„œ ì œì•ˆí•œ ë°©ë²•ì´ë‹¤.

ê° ì±„ë„ë§ˆë‹¤ ë…ë¦½ì ìœ¼ë¡œ ì»¨ë³¼ë£¨ì…˜ ì—°ì‚°ì„ ìˆ˜í–‰í•˜ì—¬ ê³µê°„ì  íŠ¹ì§•ì„ ì¶”ì¶œí•œ í›„, ì±„ë„ì„ ì„ì–´ ì±„ë„ ê°„ ìƒí˜¸ì‘ìš©ì„ ê³ ë ¤í•œë‹¤.

![fig8](dl/Conv-8.png){: style="display:block; margin:0 auto; width:80%;"}
_[[ì¶œì²˜]](https://sotudy.tistory.com/10)_

Depthwise Separable ì»¨ë³¼ë£¨ì…˜ì—ì„œì˜ ì´ ì—°ì‚°ëŸ‰ì€ ì•„ë˜ì™€ ê°™ë‹¤.

$$
\left(H\times W\times C_{in}\times K^2\right)
+\left(H\times W\times C_{in}\times C_{out}\right)
$$

ì¼ë°˜ì ìœ¼ë¡œ $K=3$ í¬ê¸°ì˜ í•„í„°ë¥¼ ì‚¬ìš©í•˜ë¯€ë¡œ, ì¼ë°˜ ì»¨ë³¼ë£¨ì…˜ ëŒ€ë¹„ ì—°ì‚°ëŸ‰ì„ ì•½ 9ë°° ì¤„ì¼ ìˆ˜ ìˆë‹¤.

$$
\frac{H\times W\times C_{in}\times C_{out}\times K^2}{\left(H\times W\times C_{in}\times K^2\right)+\left(H\times W\times C_{in}\times C_{out}\right)}
=\frac{1}{C_{out}}+\frac{1}{K^2}=\frac{1}{C_{out}}+\frac{1}{9}
\approx\frac{1}{9}
$$

## Transposed Convoltuion

ì¼ë°˜ ì»¨ë³¼ë£¨ì…˜ì€ ì¶œë ¥ í¬ê¸°ë¥¼ ì¤„ì´ëŠ” ê²½í–¥ì´ ìˆë‹¤. ì´ì™€ ë°˜ëŒ€ë¡œ Transposed ì»¨ë³¼ë£¨ì…˜ì€ ì‘ì€ íŠ¹ì§•ë§µì„ í° íŠ¹ì§•ë§µìœ¼ë¡œ í™•ì¥í•˜ëŠ” ì—°ì‚°ì´ë‹¤.

ë‹¨ìˆœíˆ bilinear, nearest neighborì™€ ê°™ì€ ì—…ìƒ˜í”Œë§ ê¸°ë²•ì„ ì‚¬ìš©í•˜ì§€ ì•Šê³ , í•™ìŠµëœ ê°€ì¤‘ì¹˜ë¡œ ì—…ìƒ˜í”Œë§í•  ìˆ˜ ìˆë‹¤ëŠ” ì ì—ì„œ ë” ì„¸ë°€í•œ ë³µì›ì´ ê°€ëŠ¥í•˜ë‹¤.

Transposed ì»¨ë³¼ë£¨ì…˜ í›„ì˜ ì¶œë ¥ë§µì˜ í¬ê¸°ëŠ” ì•„ë˜ì™€ ê°™ì´ ê³„ì‚°í•  ìˆ˜ ìˆë‹¤.

$$
O=(I-1)\cdot S-2P+K
$$

ì•„ë˜ ê·¸ë¦¼ì—ì„œ íŒŒë€ìƒ‰ì€ ì…ë ¥ë§µ $\left(I=4\right)$ì´ë©°, $K=3$, $S=1$, $P=0$ì¸ ìƒí™©ì´ë‹¤.

ìœ„ì˜ ê³µì‹ì— ë”°ë¼ ì¶œë ¥ë§µì˜ í¬ê¸°ëŠ” $(4-1)\cdot1-0+3=6$ì¸ ê²ƒì„ í™•ì¸í•  ìˆ˜ ìˆë‹¤.

![fig9](dl/Conv-9.gif){: style="display:block; margin:0 auto; width:60%;"}
_[[ì¶œì²˜]](https://medium.com/apache-mxnet/transposed-convolutions-explained-with-ms-excel-52d13030c7e8)_

## Dilated Convolution

í•„í„°ì˜ ìš”ì†Œ ì‚¬ì´ì— ì¼ì • ê°„ê²©ì„ ë‘¬ì„œ ì»¨ë³¼ë£¨ì…˜ ì—°ì‚°ì„ ìˆ˜í–‰í•œë‹¤.

ë™ì¼í•œ ì—°ì‚°ëŸ‰ìœ¼ë¡œ receptive fieldë¥¼ í™•ì¥í•  ìˆ˜ ìˆë‹¤ëŠ” ì¥ì ì´ ìˆë‹¤.

![fig10](dl/Conv-10.png){: style="display:block; margin:0 auto; width:60%;"}
_[[ì¶œì²˜]](https://peerj.com/articles/cs-2056/)_
