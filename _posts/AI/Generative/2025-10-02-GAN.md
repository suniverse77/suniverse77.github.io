---
title: "[생성 모델] GAN (Generative Adversarial Network)"
date: 2025-10-02 00:00:00 +/-TTTT
categories: [AI, 생성 모델]
tags: [생성 모델]
math: true
toc: true
author: sunho
---

## GAN

![fig1](generative/2-1.png){: style="display:block; margin:0 auto; width:70%;"}
_[[출처]](https://baechu-story.tistory.com/12)_

GAN은 크게 생성자 (Generator)와 판별자 (Discriminator)로 구성되어 있다. Generator는 실제와 유사한 데이터를 생성하는 역할을 하며, Discriminator는 입력 데이터가 실제인지 가짜인지 구별하는 역할을 한다.

이들의 개념은 주로 위조지폐범과 경찰로 비유된다.

- **Generator (위조 지폐범)**: 진짜와 구분할 수 없을 만큼 정교한 가짜 지폐를 만드는 것이 목표이다.
- **Discriminator (경찰)**: 진짜 지폐와 가짜 지폐를 정확하게 구별해내는 것이 목표이다.

GAN의 학습 과정은 아래와 같이 비유할 수 있다.

1. 위조 지폐범은 처음에 어설픈 가짜 지폐를 만들고, 경찰은 이를 쉽게 가짜 지폐라고 판별한다.
2. 위조범은 '어떻게 만들었더니 가짜라고 들켰는지' 피드백을 받아, 더 정교한 가짜 지폐를 만든다.
3. 경찰도 '어떤 점이 진짜와 달랐는지'를 학습하며, 판별 능력을 키운다.

위 과정을 반복하게 되면, 위조범은 경찰조차 속을 만큼 진짜 같은 가짜 지폐를 만들게 되고, 경찰은 아주 미세한 차이도 구별해내는 감식가가 된다.

### GAN의 학습 과정

![fig2](generative/2-2.png){: style="display:block; margin:0 auto; width:70%;"}
_[[출처]](https://wikidocs.net/146217)_

생성자 (Generator)를 $G$, 식별자 (Discriminator) $D$로 표기한다.

실제 이미지의 라벨은 $1$, 가짜 이미지의 라벨은 $0$으로 설정된다.

1. $G$에게 랜덤한 노이즈 벡터를 입력한다.
2. $G$는 입력된 노이즈를 이용해 가짜 이미지를 생성한다.
3. 실제 이미지와 $G$가 생성한 가짜 이미지를 섞어서 $D$에게 입력한다.
4. $D$는 실제 이미지를 $1$로, 가짜 이미지를 $0$으로 구별하도록 학습한다.
5. $G$는 $D$를 속이기 위해 더욱 정교하게 이미지를 생성하도록 학습한다.

![fig3](generative/2-3.png){: style="display:block; margin:0 auto; width:70%;"}
_출처: [Generative Adversarial Networks](https://arxiv.org/abs/1406.2661)_

최종적으로 

#### 목적 함수

GAN의 목적 함수는 아래와 같다.

$$
\min_\theta\max_\phi
\left[
\mathbb{E}_{x\sim p_{data}}\log D_\phi(x)+
\mathbb{E}_{z\sim p(z)}\log(1-D_\phi(G_\theta(z))
\right]
$$

여기서 $\theta$는 Generator의 파라미터, $\phi$는 Discriminator의 파라미터를 의미한다.

Discriminator는 아래의 식을 최대화하도록 학습된다.

$$
\mathbb{E}_{x\sim p_{data}}\log D_\phi(x)+
\mathbb{E}_{z\sim p(z)}\log(1-D_\phi(G_\theta(z))
$$

실제 데이터 $x$를 $1$로, 가짜 데이터 $$를 $0$으로 잘 판별하면

Generator는 아래의 식을 최소화하도록 학습된다.

$$
\mathbb{E}_{z\sim p(z)}\log(1-D_\phi(G_\theta(z))
$$

#### Zero-sum Game

GAN은 두 개의 신경망이 서로 경쟁하는 '제로섬 게임(Zero-sum Game)으로 볼 수 있다.

이 경쟁이 반복되면, 생성자는 점점 더 정교한 가짜를 만들고, 판별자는 점점 더 예리한 감식안을 갖게 된다. 이 게임이 이상적인 균형점인 내쉬 균형 (Nash Equilibrium)에 도달하면, 생성자가 만든 가짜는 진짜와 통계적으로 구별이 불가능할 정도로 완벽해진다.

이 상태가 바로 Discriminator가 $0.5$를 출력하는 순간이다. 

이는 Discriminator가 멍청해져서 구별을 못 하는 것이 아니라, Generator가 너무 완벽한 가짜를 만들어서 Discriminator이 자신이 가진 모든 지식을 총동원해도 주어진 데이터가 진짜인지 가짜인지 구별할 근거가 전혀 없는 상태를 의미한다.

즉, Discriminator가 '진짜일 확률 50%, 가짜일 확률 50%'라고 판단할 수밖에 없는 것이다.

## Mode Collapse

Mode Collapse는 Generator가 다양한 이미지를 생성하지 못하고, 비슷한 이미지만 계속해서 생성하는 경우를 의미한다.

생성자가 판별자를 속이기 쉬운 몇 가지 결과물만 계속 생성하는 '모드 붕괴(Mode Collapse)' 같은 고질적인 문제가 발생하

![fig4](generative/2-4.png){: style="display:block; margin:0 auto; width:70%;"}
_[[출처]](https://dev-hani.tistory.com/15)_