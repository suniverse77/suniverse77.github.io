---
title: "[생성 모델] VAE (Variational Auto Encoder)"
date: 2025-10-01 00:00:00 +/-TTTT
categories: [AI, 생성 모델]
tags: [생성 모델]
math: true
toc: true
author: sunho
---

## 변분 오토인코더 (Variational Auto Encoder)

$$
q_\phi(\bold z|\bold x)=\mathcal{N}(\bold z;\boldsymbol\mu_\phi(\bold x),\boldsymbol\sigma^2_\phi(\bold x)\bold I)
$$

- Encoder는 Multivariate Gaussian으로 설정

$$
p(\bold z)=\mathcal{N}(\bold z;\bold0,\bold I)
$$

- Prior는 Standard Multivariate Gaussian으로 설정

### Encoder

- 각 feature에 대한 평균과 분산을 출력함: $\bold z\in\mathbb{R}^D\to\boldsymbol \mu\in\mathbb{R}^D$
- $\bold z$의 각 $z_i$는 Gaussian을 따름

### Sampling

- Decoder의 입력을 위해서 하나의 $\bold z$값이 필요하기 때문에, 샘플링이 필요함
    
    샘플링하는 $\bold z$값마다 다른 이미지가 생성됨
    
- $z$를 단순히 샘플링하면 backpropagation이 불가능하므로, reparameterization trick 사용
    - $x=\mu+\sigma\epsilon~,~\epsilon\sim\mathcal{N}(\epsilon;0,I)$
    - $\bold z=\boldsymbol\mu_\phi(\bold x)+\boldsymbol\sigma_\phi(\bold x)\boldsymbol\epsilon~,~\boldsymbol\epsilon\sim\mathcal{N}(\boldsymbol\epsilon;\bold 0,\bold I)$

### Decoder

- 샘플링된 $\bold z$를 이용해 이미지 생성

## Hierarchical VAE (HVAE)

- VAE의 latent variable을 여러 층으로 쌓은 모델
- $t$시점의 latent는 $t+1$시점의 latent의 영향만 받는다는 Markov 가정 하에 진행
    
    $p(z_t|z_{t+1},z_{t+2},\dots)$는 매우 복잡하기 때문에 풀어쓸 수 없음
    

### Encoder

$$
q_\phi(z_{1:T}|x)=q_\phi(z_{1}|x)\prod_{t=2}^Tq_\phi(z_t|z_{t-1})
$$

- 처음 step에는 $x$가 포함되어 있으므로, $\prod$ 안에 넣을 수 없음

### Decoder

$$
p(x,z_{1:T})=p(z_T)p_\theta(x|z_1)\prod_{t=2}^Tp_\theta(z_{t-1}|z_t)
$$

- Latent가 여러 층이므로 VAE와 달리 $z_{1:T}$로 표현
- 우변은 Markov 정의에 의해 나온 식임
