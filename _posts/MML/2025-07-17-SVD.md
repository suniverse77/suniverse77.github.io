---
title: "[선형대수] 특이값 분해 (SVD)"
date: 2025-07-17 00:00:00 +/-TTTT
categories: [인공지능 수학, 선형대수]
tags: [선형대수]
math: true
toc: true
author: sunho
img_path: /assets/images/math/
---

## 특이값 분해 (SVD - Singularvalue Decomposition)

SVD는 EVD와 달리 어떠한 행렬이든 3개의 행렬로 분해가 가능하다.

![fig1](mlm/16-1.png){: style="display:block; margin:0 auto; width:50%;"}
_[[출처]](https://my-mindpalace.tistory.com/10)_

$$
A=U\Sigma V^\top
$$

- $U\in\mathbb{R}^{m\times m}$: 각 열이 $A$의 특이 벡터들로 구성된 직교 행렬
- $\Sigma\in\mathbb{R}^{m\times n}$: 주대각선에 $A$의 특이값들이 크기순으로 나열된 대각 행렬
- $V\in\mathbb{R}^{n\times n}$: 각 열이 $A$의 특이 벡터들로 구성된 직교 행렬

### SVD의 기하학적 의미

![fig2](mlm/16-2.png){: style="display:block; margin:0 auto; width:70%;"}
_[[출처]](https://my-mindpalace.tistory.com/10)_

- $V^\top$는 입력 공간의 basis를 회전시킨다.
- $\Sigma$는 회전된 basis를 특이값의 크기만큼 늘리거나 줄인다. $\Sigma$는 비정사각행렬 $\mathbb{R}^{m\times n}$이기 때문에 출력 공간의
 차원을 늘리거나 줄일 수도 있다.
- $U$는 출력 공간의 basis를 다시 회전시킨다.

## EVD와 SVD의 관계

SVD는 EVD를 일반화한 개념이며, $A^\top A$와 $AA^\top$ 행렬의 EVD를 통해 SVD를 이해할 수 있다.

$A^\top A$와 $AA^\top$는 대칭 행렬이기 때문에 항상 EVD가 가능하다.

**$A^\top A$와 $V$의 관계**

$A^\top A$의 고유벡터들은 SVD의 오른쪽 특이 벡터 행렬 $V$를 구성한다.

$A^\top A$의 고유값 $\lambda_i$는 행렬 $A$의 특이값 $\sigma_i$
의 제곱과 같다.

$$
\lambda_i=\sigma_i^2
$$

<details>
<summary><font color='#0000FF'>증명</font></summary>
<div markdown="1">

$A^\top A=(U\Sigma V^\top)^\top(U\Sigma V^\top)=V\Sigma^\top (U^\top U)\Sigma V^\top=V(\Sigma^\top\Sigma) V^\top$

$$
A^\top A=V(\Sigma\Sigma^\top) V^\top=V\begin{bmatrix}\sigma_1^2&\cdots&0\\\vdots&\ddots&\vdots\\0&\cdots&\sigma_n^2\end{bmatrix}V^\top
$$

$A^\top A$는 symmetric matrix이므로, 항상 EVD가 가능하다.

$$
A^\top A=PDP^\top=P\begin{bmatrix}\lambda_1&\cdots&0\\\vdots&\ddots&\vdots\\0&\cdots&\lambda_n\end{bmatrix}P^\top
$$

SVD와 EVD를 비교해보면 $V=P$, $\sigma_i^2=\lambda_i$이다.

따라서, $V$는 $A^\top A$의 고유벡터들로 구성되어있으며, $A^\top A$의 고유값은 $A$의 특이값의 제곱이다.

</div>
</details>
<br>

**$AA^\top$와 $U$의 관계**

$AA^\top$의 고유벡터들은 SVD의 왼쪽 특이 벡터 행렬 $U$를 구성한다.

$AA^\top$의 고유값 $\lambda_i$는 행렬 $A$의 특이값 $\sigma_i$
의 제곱과 같다.

$$
\lambda_i=\sigma_i^2
$$

<details>
<summary><font color='#0000FF'>증명</font></summary>
<div markdown="1">

$AA^\top=(U\Sigma V^\top)(U\Sigma V^\top)^\top=U\Sigma (V^\top V)\Sigma^\top U^\top=U(\Sigma\Sigma^\top)^\top$

$$
AA^\top=U(\Sigma\Sigma^\top) U^\top=U\begin{bmatrix}\sigma_1^2&\cdots&0\\\vdots&\ddots&\vdots\\0&\cdots&\sigma_m^2\end{bmatrix}U^\top
$$

$AA^\top$는 symmetric matrix이므로, 항상 EVD가 가능하다.

$$
AA^\top=PDP^\top=P\begin{bmatrix}\lambda_1&\cdots&0\\\vdots&\ddots&\vdots\\0&\cdots&\lambda_n\end{bmatrix}P^\top
$$

SVD와 EVD를 비교해보면 $U=P$, $\sigma_i^2=\lambda_i$이다.

따라서, $U$는 $AA^\top$의 고유벡터들로 구성되어있으며, $AA^\top$의 고유값은 $A$의 특이값의 제곱이다.

</div>
</details>
<br>

SVD를 계산할 때 두 행렬 $A^\top A$와 $AA^\top$에 대해 두 번의 EVD를 계산할 필요 없이, 하나에 대해 EVD를 계산한 뒤 아래의 공식을 사용해서 나머지 행렬을 구할 수 있다.

$$
\mathbf{u}_i=\frac{1}{\sigma_i}A\mathbf{v}_i
$$

- $\mathbf{v}_i$: $V$의 $i$번째 열벡터
- $\mathbf{u}_i$: $U$의 $i$번째 열벡터

<details>
<summary><font color='#0000FF'>공식 유도</font></summary>
<div markdown="1">

$$
A=U\Sigma V^\top~\to~AV=U\Sigma
$$

$AV$ 행렬의 각 열은 $A\mathbf{v}_i$이다.

$U\Sigma$ 행렬의 각 열은 $\mathbf{u}_i\sigma_i$이다.

따라서, $A\mathbf{v}_i=\mathbf{u}_i\sigma_i$이다.

</div>
</details>
<br>

---

간단히 말해 행렬 $A$가 있을 때 $A^\top A$와 $AA^\top$에 대해 EVD를 수행하면, 그 고유벡터와 고유값을 이용해 $A$의 SVD를 구성할 수 있다는 것이다.

<details>
<summary><font color='#FF0000'>Example</font></summary>
<div markdown="1">

$$
A=\begin{bmatrix}1&5&0\\5&1&0\end{bmatrix}
$$

---

**1. $\Sigma$ 구하기**

1. $AA^\top$에 대해 EVD 수행한다. ($A^\top A$도 가능)

    $$
    AA^\top=\begin{bmatrix}26&10\\10&26\end{bmatrix}
    $$

    $$
    \lambda_1=36~,~\lambda_2=16
    $$   

2. 고유값을 이용해 특이값을 계산한다.

    $$
    \sigma_1=\sqrt{\lambda_1}=6~,~\sigma_2=\sqrt{\lambda_2}=4
    $$

3. 크기가 큰 순서대로 정렬하여 주대각선에 배치한다. ($\Sigma$의 크기는 $A$와 동일)

    $$
    \Sigma=\begin{bmatrix}6&0&0\\0&4&0\end{bmatrix}
    $$

**2. $V$ 구하기**

1. $A^\top A$ 구성

    $$
    A^\top A=\begin{bmatrix}26&10&0\\10&26&0\\0&0&0\end{bmatrix}
    $$

2. EVD를 수행하여 고유값과 고유벡터를 얻는다.

    $$
    \lambda_1=36~,~\lambda_2=16~,~\lambda_3=0
    $$
    
    $$
    \mathbf{x}_1=\begin{bmatrix}1\\1\\0\end{bmatrix}~,~
    \mathbf{x}_2=\begin{bmatrix}1\\-1\\0\end{bmatrix}~,~
    \mathbf{x}_3=\begin{bmatrix}0\\0\\1\end{bmatrix}
    $$

3. 고유벡터를 정규화하여 행렬 $V$를 구성한다.

    $$
    \mathbf{v}_1=\begin{bmatrix}\frac{1}{\sqrt2}\\\frac{1}{\sqrt2}\\0\end{bmatrix}~,~
    \mathbf{v}_2=\begin{bmatrix}\frac{1}{\sqrt2}\\-\frac{1}{\sqrt2}\\0\end{bmatrix}~,~
    \mathbf{v}_3=\begin{bmatrix}0\\0\\1\end{bmatrix}
    $$

    $$
    V=\begin{bmatrix}\frac{1}{\sqrt2}&\frac{1}{\sqrt2}&0\\\frac{1}{\sqrt2}&-\frac{1}{\sqrt2}&0\\0&0&1\end{bmatrix}
    $$

**3. $U$ 구하기**

1. $\mathbf{u}_i=\frac{1}{\sigma_i}A\mathbf{v}_i$ 공식을 이용해 $\mathbf{u}_i$를 계산한다.

    $$
    \mathbf{u}_1=\frac{1}{6}\begin{bmatrix}1&5&0\\5&1&0\end{bmatrix}\begin{bmatrix}\frac{1}{\sqrt2}\\\frac{1}{\sqrt2}\\0\end{bmatrix}
    =\begin{bmatrix}\frac{1}{\sqrt2}\\\frac{1}{\sqrt2}\end{bmatrix}
    $$

    $$
    \mathbf{u}_2=\frac{1}{4}\begin{bmatrix}1&5&0\\5&1&0\end{bmatrix}\begin{bmatrix}\frac{1}{\sqrt2}\\-\frac{1}{\sqrt2}\\0\end{bmatrix}
    =\begin{bmatrix}-\frac{1}{\sqrt2}\\\frac{1}{\sqrt2}\end{bmatrix}
    $$

2. $U$를 구성한다.

    $$
    U=\begin{bmatrix}\frac{1}{\sqrt2}&-\frac{1}{\sqrt2}\\\frac{1}{\sqrt2}&\frac{1}{\sqrt2}\end{bmatrix}
    $$

**4. 최종적인 SVD 결과**

$$
\begin{bmatrix}1&5&0\\5&1&0\end{bmatrix}=
\begin{bmatrix}\frac{1}{\sqrt2}&-\frac{1}{\sqrt2}\\\frac{1}{\sqrt2}&\frac{1}{\sqrt2}\end{bmatrix}
\begin{bmatrix}6&0&0\\0&4&0\end{bmatrix}
\begin{bmatrix}\frac{1}{\sqrt2}&\frac{1}{\sqrt2}&0\\\frac{1}{\sqrt2}&-\frac{1}{\sqrt2}&0\\0&0&1\end{bmatrix}
$$

</div>
</details>
<br>
