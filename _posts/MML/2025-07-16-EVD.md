---
title: "[선형대수] 고유값 분해 (EVD)"
date: 2025-07-16 00:00:00 +/-TTTT
categories: [인공지능 수학, 선형대수]
tags: [선형대수]
math: true
toc: true
author: sunho
---

## 대각화 (Diagonalization)

정방 행렬 $A$와 대각 행렬 $D$에 대해서 아래의 식이 성립하도록 하는 가역 행렬 $P$가 존재한다면, $A$는 대각화 가능 (diagonlizable)하다고 하고, $P$는 $A$를 대각화한다고 한다. 

$$
P^{-1}AP=D
$$

아래에서 다루겠지만, $P$는 $A$의 고유벡터들로 구성된 행렬이며 $D$는 고유값이 대각 성분을 이루는 행렬이다.

행렬을 대각화 하는 이유는 대각 행렬로 바꾸면 연산이 훨씬 간단해지기 때문이다. ([대각 행렬의 성질](https://suniverse77.github.io/posts/Matrix/#%EB%8C%80%EA%B0%81-%ED%96%89%EB%A0%AC%EC%9D%98-%EC%84%B1%EC%A7%88) 참고)

### 닮음 (similiar)

행렬 $A$ , $Y$와 가역 행렬 $B$에 대해 아래의 식을 만족한다면, $A$와 $Y$가 닮음 (similar)이라고 한다.

$$
B^{-1}AB=Y
$$

Similar하다는 뜻은 $A$의 특성 방정식 $\text{det}(A-\lambda I)$와 $Y$의 특성 방정식 $\text{det}(Y-\lambda I)$가 같다는 뜻이다. (역은 성립하지 않음)

## 고유값 분해 (EVD - Eigenvalue Decomposition)

EVD는 정방 행렬 $A$를 고유벡터 행렬과 고유값이 대각 원소로 구성된 대각행렬로 분해하는 방법이다.

$$
A=V\Lambda V^{-1}
$$

- $V$: 각 열이 $A$의 고유벡터들로 구성된 행렬
- $\Lambda$: 주대각선에 $A$의 고유값들이 나열된 대각 행렬

행렬 $A$에 대한 복잡한 계산을 간단한 대각 행렬 $\Lambda$의 계산으로 바꿀 수 있다.

<details>
<summary><font color='#0000FF'>공식 유도</font></summary>
<div markdown="1">

$$
A\mathbf{v}_1=\lambda_1\mathbf{v}_1~,~\cdots~,~A\mathbf{v}_n=\lambda_n\mathbf{v}_n
$$

행렬 $A$가 여러 개의 고유값과 고유벡터를 가진다면 아래와 같이 표현할 수 있다.

$$
A
\begin{bmatrix}|&|&&|\\\mathbf{v}_1&\mathbf{v}_2&\cdots&\mathbf{v}_n\\|&|&&|\end{bmatrix}=
\begin{bmatrix}|&|&&|\\\mathbf{v}_1&\mathbf{v}_2&\cdots&\mathbf{v}_n\\|&|&&|\end{bmatrix}
\begin{bmatrix}\lambda_1&0&\cdots&0\\0&\lambda_2&\cdots&0\\\vdots&\vdots&\ddots&0\\0&0&0&\lambda_n\end{bmatrix}
$$

이를 행렬로 표현하면 아래와 같다.

$$
AV=V\Lambda
$$

모든 고유벡터들이 선형 독립이라면, $V$는 역행렬이 존재하기 때문에 아래의 식이 성립한다.

$$
A=V\Lambda V^{-1}
$$

---

</div>
</details>
<br>

중요한 정리가 있다.

1. 정방 행렬에서 서로 다른 고유값에 대응하는 고유벡터들은 항상 서로 선형 독립이다.
2. 대칭 행렬에서 서로 다른 고유값에 대응하는 고유벡터들은 항상 직교 관계이다.

<details>
<summary><font color='#0000FF'>1번 증명</font></summary>
<div markdown="1">

서로 다른 고유값 $\lambda_1$ , $\lambda_2$에 대응되는 고유벡터 $\mathbf{v}_1$ , $\mathbf{v}_2$가 선형 종속이라고 가정하자.

선형 종속이기 때문에 아래와 같이 표현할 수 있고, 고유벡터는 영벡터가 아니므로 $c\neq0$이다. 

$$
\mathbf{v}_1=c\mathbf{v}_2
$$

양변에 행렬 $A$를 곱해 정리한다.

$$
A\mathbf{v}_1=A(c\mathbf{v}_2)=c(A\mathbf{v}_1)
$$

$\mathbf{v}_1=c\mathbf{v}_2$를 대입하여 정리한다.

$$
\lambda_1\mathbf{v}_1=c(\lambda_2\mathbf{v}_2)
~\to~\lambda_1(c\mathbf{v}_2)=c(\lambda_2\mathbf{v}_2)
$$

최종적으로 아래와 같이 정리된다.

$$
c(\lambda_1-\lambda_2)\mathbf{v}_2=0
$$

위 식이 성립하기 위해서는 $c=0$ 또는 $\lambda_1=\lambda_2$ 또는 $\mathbf{v}_2=\mathbf{0}$이어야 한다.

하지만 셋 다 성립할 수 없으므로, 서로 다른 고유값에 대응되는 고유벡터는 선형 독립임을 알 수 있다.

---

</div>
</details>

<details>
<summary><font color='#0000FF'>2번 증명</font></summary>
<div markdown="1">

$$
A=V\Lambda V^{-1}~~,~~A^\top=\left(V\Lambda V^{-1}\right)^\top
$$

대칭 행렬이기 때문에 $A=A^\top$이다.

$$
V\Lambda V^{-1}=\left(V\Lambda V^{-1}\right)^\top
$$

위 식을 아래와 같이 전개할 수 있다.

$$
V\Lambda V^{-1}=\left(V\Lambda V^{-1}\right)^\top
=V^{-\top}\Lambda^\top V^\top=\left(V^\top\right)^{-1}\Lambda V^\top
$$

위 식의 좌변과 우변이 같으려면 아래의 식이 성립해야 한다.

$$
V^{-1}=V^\top
$$

따라서 $V$는 직교 행렬이다.

---

$$
\lambda_1\mathbf{v}_1\cdot\mathbf{v}_2=()
$$

---

</div>
</details>
<br>

즉, $A$가 대칭 행렬일 때 $V$는 직교 행렬이기 때문에 아래와 같이 표현할 수 있다.

$$
A=V\Lambda V^\top
$$

또한 대칭 행렬의 고유값은 항상 실수이기 때문에 <span style="background-color:#fff5b1">대칭 행렬은 항상 EVD가 가능하다.</span>

일반적으로 직교 행렬인 경우, $V$ 대신 $Q$로도 표현한다.

$$
A=Q\Lambda Q^\top
$$

### EVD의 성질

EVD는 아래의 연산을 매우 간단하게 만들어 준다. ([대각 행렬의 성질](https://suniverse77.github.io/posts/Matrix/#%EB%8C%80%EA%B0%81-%ED%96%89%EB%A0%AC%EC%9D%98-%EC%84%B1%EC%A7%88) 참고)

1. 거듭제곱 연산: 대각 행렬 $\Lambda$만 $k$제곱 하면 된다.

   $$
   A^k=(V\Lambda V^{-1})^k=(V\Lambda V^{-1})\cdots(V\Lambda V^{-1})=V\Lambda^kV^{-1}
   $$

2. 역행렬 계산: 대각 행렬 $\Lambda$의 역행렬을 구하면 된다.

   $$
   A^{-1}=(V\Lambda V^{-1})^{-1}=V\Lambda^{-1}V^{-1}
   $$

3. 행렬식 계산: 행렬 $A$의 행렬식은 모든 고유값의 곱과 같다.

   $$
   \text{det}(A)=\text{det}(V\Lambda V^{-1})=\text{det}(V)\text{det}(\Lambda)\text{det}(V^{-1})=\text{det}(\Lambda)=\prod_{i=1}^n\lambda_i
   $$

4. 트레이스 계산: 행렬 $A$의 트레이스는 모든 고유값의 합과 같다.

   $$
   \text{tr}(A)=\sum_{i=1}^n\lambda_i
   $$

### EVD의 조건

모든 정방 행렬이 EVD가 가능한 것은 아니며, $V$가 가역 행렬일 때 EVD가 가능하다.

$V$가 가역 행렬이라는 뜻은 $A$의 고유벡터들이 모두 선형 독립이어야 한다

이 조건은 대수적 중복도 (Algebraic Multiplicity)와 기하적 중복도 (Gemoetric Multiplicity)가 같은 경우 성립한다.

- **Algebraic Multiplicity**: 특성 방정식에서 고유값의 중복 횟수를 의미한다.
- **Gemoetric Multiplicity**: 고유값에 대응하는 고유벡터들의 개수로,  null space의 차원과 같다.

<details>
<summary><font color='red'>Example</font></summary>
<div markdown="1">

$$
A=\begin{bmatrix}2&1\\0&2\end{bmatrix}
$$

---

$\lambda_1=\lambda_2=2$이므로, 2개의 중복 고유값을 가진다. → Algebraic Multiplicity = 2

해당 고유값에 대응하는 고유벡터는 1개다. → Gemoetric Multiplicity = 1

Algebraic Multiplicity $\not=$ Gemoetric Multiplicity이므로, $A$는 EVD가 불가능하다.

</div>
</details>
