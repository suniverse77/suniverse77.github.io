---
title: "[선형대수] LU 분해"
date: 2025-07-09 06:00:00 +/-TTTT
categories: [인공지능 수학, 선형대수]
tags: [선형대수]
math: true
toc: true
author: sunho
---

## LU 분해 (LU Decomposition)

LU 분해는 정사각 행렬 $A$를 상삼각 행렬 $U$와 하삼각 행렬 $L$의 곱으로 분해하는 방법을 의미한다.

$$
A=LU
$$

이때 $L$은 대각 성분이 모두 1인 하삼각 행렬이다.

$A\mathbf{x}=\mathbf{b}$ 대신 $(LU)\mathbf{x}=\mathbf{b}$를 풀며, 과정은 아래와 같다.

1. **Forward substitution**: $U\mathbf{x}=\mathbf{y}$로 치환해서 $L\mathbf{y}=\mathbf{b}$를 푼다.
2. **Backward substitution**: $U\mathbf{x}=\mathbf{y}$를 푼다.

$A$가 고정이고 $\mathbf{b}$만 계속 바뀌는 경우, $L$ , $U$를 한 번만 계산해 두면 이후에는 새로운 해를 빠르게 구할 수 있다.

### 기본 행렬 (Elementary Matrix)

기본 행 연산은 행렬 곱셈으로도로 표현할 수 있다. 즉, 어떤 행 연산을 행렬 $A$에 적용하는 것은 그에 대응하는 기본 행렬 $E$를 왼쪽에서 곱하는 것과 같다.

이때 기본 행렬은 단위 행렬을 해당 행 연산으로 변형한 행렬이다.

예를 들어, $R_2\to R_2-R_1$ 연산을 아래와 같이 $E$를 곱하는 것으로 표현할 수 있다.

$$
EA=
\begin{bmatrix}1&0&0\\-1&1&0\\0&0&1\end{bmatrix}
\begin{bmatrix}1&2&3\\4&5&6\\7&8&9\end{bmatrix}
=\begin{bmatrix}1&2&3\\3&3&3\\7&8&9\end{bmatrix}
$$

기본 행렬의 역행렬은 아래와 같다.

1. 행 교환 행렬의 역행렬은 자기 자신이다.

   $$
   E=\begin{bmatrix}1&0&0\\0&0&1\\0&1&0\end{bmatrix}
   ~\to~
   E^{-1}=\begin{bmatrix}1&0&0\\0&0&1\\0&1&0\end{bmatrix}
   $$
2. 행 상수배 행렬의 역행렬은 대각 행렬의 역행렬과 같다.

   $$
   E=\begin{bmatrix}1&0&0\\0&3&0\\0&0&1\end{bmatrix}
   ~\to~
   E^{-1}=\begin{bmatrix}1&0&0\\0&\frac{1}{3}&0\\0&0&1\end{bmatrix}
   $$
3. 행 덧셈 행렬의 역행렬은 부호를 바꾸면 된다.

   $$
   E=\begin{bmatrix}1&0&0\\0&1&0\\-2&0&1\end{bmatrix}
   ~\to~
   E^{-1}=\begin{bmatrix}1&0&0\\0&1&0\\2&0&1\end{bmatrix}
   $$

<details>
<summary><font color='#FF0000'>Example 1</font></summary>
<div markdown="1">

$$
\begin{bmatrix}\begin{array}{ccc|c}2&4&-2&2\\4&9&-3&8\\-2&-3&7&10\end{array}\end{bmatrix}
$$

---

**1. 가우스 소거법을 이용해 $U$ 구하기**

1. $R_2\rightarrow R_2-2R_1$

   $$
   \begin{bmatrix}1&0&0\\0&1&-2\\0&0&1\end{bmatrix}
   \begin{bmatrix}2&4&-2\\4&9&-3\\-2&-3&7\end{bmatrix}
   =\begin{bmatrix}2&4&-2\\0&1&1\\-2&-3&7\end{bmatrix}
   $$

2. $R_3\rightarrow R_3+R_1$

   $$
   \begin{bmatrix}1&0&0\\0&1&0\\1&0&1\end{bmatrix}
   \begin{bmatrix}2&4&-2\\0&1&1\\-2&-3&7\end{bmatrix}
   =\begin{bmatrix}2&4&-2\\0&1&1\\0&1&5\end{bmatrix}
   $$

3. $R_3\rightarrow R_3-R_2$

   $$
   \begin{bmatrix}1&0&0\\0&1&0\\0&-1&1\end{bmatrix}
   \begin{bmatrix}2&4&-2\\0&1&1\\0&1&5\end{bmatrix}
   =\begin{bmatrix}2&4&-2\\0&1&1\\0&0&4\end{bmatrix}=U
   $$

**2. 기본 행렬을 이용해 $L$ 구하기**

위의 가우스 소거법 과정은 아래와 같이 표현할 수 있다.

$$
(E_3E_2E_1)A=U
$$

$E_i$는 모두 대각 성분이 1인 하삼각 행렬이며, 

$$
A=(E_3E_2E_1)^{-1}U=(E_1^{-1}E_2^{-1}E_3^{-1})U=LU
$$

$$
L=
\begin{bmatrix}1&0&0\\2&1&0\\0&0&1\end{bmatrix}
\begin{bmatrix}1&0&0\\0&1&0\\-1&0&1\end{bmatrix}
\begin{bmatrix}1&0&0\\0&1&0\\0&-1&1\end{bmatrix}
=\begin{bmatrix}1&0&0\\2&1&0\\-1&1&1\end{bmatrix}
$$

**3. $L\mathbf{y}=\mathbf{b}$ 풀기**

$$
\begin{bmatrix}1&0&0\\2&1&0\\-1&1&1\end{bmatrix}
\begin{bmatrix}y_1\\y_2\\y_3\end{bmatrix}
=\begin{bmatrix}2\\8\\10\end{bmatrix}
~\to~\mathbf{y}=\begin{bmatrix}2\\4\\8\end{bmatrix}
$$

**4. $U\mathbf{x}=\mathbf{y}$ 풀기**

$$
\begin{bmatrix}2&4&-2\\0&1&1\\0&0&4\end{bmatrix}
\begin{bmatrix}x_1\\x_2\\x_3\end{bmatrix}
=\begin{bmatrix}2\\4\\8\end{bmatrix}
~\to~\mathbf{x}=\begin{bmatrix}-1\\2\\2\end{bmatrix}
$$

---

</div>
</details>
