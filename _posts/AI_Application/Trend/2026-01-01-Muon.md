---
title: "[최적화] Muon Optimizer"
date: 2026-01-01 00:00:00 +/-TTTT
categories: [AI, New]
tags: [3D Vision]
math: true
toc: true
author: sunho
---

Muon Optimizer는 

## 기존 Adam optimizer의 한계

### 1. 메모리 효율성 문제

Adam의 업데이트 공식은 아래와 같으며, 각 파라미터마다 $m$과 $v$ 2개의 변수를 추가로 저장해야 한다.

$$
\theta_{t+1}=\theta_t-\eta\frac{\hat{m}_t}{\sqrt{\hat{v}_t}+\epsilon}
$$

예를 들어 Linear layer에서 $3\times2$ 크기의 가중치 행렬이 있다면, 그와 동일한 크기의 행렬을 저장해야 한다.

$$
W=\begin{bmatrix}
w_{11}&w_{12}\\
w_{21}&w_{22}\\
w_{31}&w_{32}
\end{bmatrix}
~~,~~
M=\begin{bmatrix}
m_{11}&m_{12}\\
m_{21}&m_{22}\\
m_{31}&m_{32}
\end{bmatrix}
~~,~~
V=\begin{bmatrix}
v_{11}&v_{12}\\
v_{21}&v_{22}\\
v_{31}&v_{32}
\end{bmatrix}
$$

결과적으로, Optimizer State가 모델 파라미터 자체보다 2배 더 많은 메모리를 차지하게 된다.

### 2. 구조적 관계 무시

Adam은 Vector-based Optimizer이다.
이러한 방식은 가중치 행렬을 행렬로 보지 않고, 단순히 하나의 긴 벡터로 취급하여 각 원소들을 독립적으로 업데이트한다.

즉, $3\times2$ 가중치 행렬을 단순히 6개의 나열된 숫자로 취급한다.

이 과정에서 각 파라미터가 서로의 상관관계를 무시한 채 개별적인 보폭으로 업데이트되면서, 가중치 간의 스케일 불균형이 발생한다.

결과적으로 특정 방향의 특이값만 커지는 현상이 나타나며, Low-rank 행렬이 되는 문제로 이어진다.

## Muon optimizer

업데이트 행렬의 rank가 낮은 경우

희귀하고 표현되지 않은 작은 feature들이 존재하며, 이들을 강화하면 최적화가 잘 될 것이다라는 가설을 세웠다.

Muon은 가중치 행렬을 단순한 벡터가 아닌 행렬 그 자체

$$
\rho(X)=aX+b(XX^\top)X
$$

$$
\rho(X)=U(aS+bS^3)V^\top
$$

1. SVD $X=USV^\top$ 대입

    $$
    \rho(X)=aUSV^\top+b\left(USV^\top (USV^\top)^\top\right)USV^\top
    $$
2. $UU^\top=I$ 이용해 두 번째 항 정리

    $$
    \left(USV^\top VS^\top U^\top\right)USV^\top
    =USS^\top SV^\top=US^3V^\top
    $$

3. 정리

    $$
    \rho(X)=aUSV^\top+bUS^3V^\top=U(aS+bS^3)V^\top
    $$
